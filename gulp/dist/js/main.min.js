var EventDispatcher=function(){function t(){this._events={}}return t.prototype.hasEventListener=function(t){return!!this._events[t]},t.prototype.addEventListener=function(t,e){if(this.hasEventListener(t)){var o=this._events[t];for(var n in o)if(o[n]===e)return;o.push(e)}else this._events[t]=[e];return this},t.prototype.removeEventListener=function(t,e){if(this.hasEventListener(t)){for(var o,n=this._events[t],i=n.length;i--;)n[i]===e&&(o=i);return n.splice(o,i),this}},t.prototype.fireEvent=function(t,e){if(this.hasEventListener(t)){var o=this._events[t],n=this.merge([],o),i=this.merge([],arguments);i.splice(0,2);for(var r in n)n[r].apply(e||this,i)}},t.prototype.merge=function(t,e){for(var o=+e.length,n=0,i=t.length;o>n;)t[i++]=e[n++];if(o!==o)for(;void 0!==e[n];)t[i++]=e[n++];return t.length=i,t},t}(),Greeter=function(){function t(t){this.greeting=t}return t.prototype.greet=function(){return this.greeting},t}(),greeter=new Greeter("Hello, world!"),greetEl=document.createElement("div"),greetHeading=document.createElement("h2"),str=greeter.greet();greetHeading.textContent=str,greetEl.appendChild(greetHeading),document.body.appendChild(greetEl),function(){"use strict";return console.log("hello world!"),$(function(){})}(this,this.document);var __extends=this.__extends||function(t,e){function o(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);o.prototype=e.prototype,t.prototype=new o},Todo=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.defaults=function(){return{content:"empty todo...",done:!1}},e.prototype.initialize=function(){this.get("content")||this.set({content:this.defaults().content})},e.prototype.toggle=function(){this.save({done:!this.get("done")})},e.prototype.clear=function(){this.destroy()},e}(Backbone.Model),TodoList=function(t){function e(){t.apply(this,arguments),this.model=Todo,this.localStorage=new Store("todos-backbone")}return __extends(e,t),e.prototype.done=function(){return this.filter(function(t){return t.get("done")})},e.prototype.remaining=function(){return this.without.apply(this,this.done())},e.prototype.nextOrder=function(){return this.length?this.last().get("order")+1:1},e.prototype.comparator=function(t){return t.get("order")},e}(Backbone.Collection),Todos=new TodoList,TodoView=function(t){function e(e){this.tagName="li",this.events={"click .check":"toggleDone","dblclick label.todo-content":"edit","click span.todo-destroy":"clear","keypress .todo-input":"updateOnEnter","blur .todo-input":"close"},t.call(this,e),this.template=_.template($("#item-template").html()),_.bindAll(this,"render","close","remove"),this.model.bind("change",this.render),this.model.bind("destroy",this.remove)}return __extends(e,t),e.prototype.render=function(){return this.$el.html(this.template(this.model.toJSON())),this.input=this.$(".todo-input"),this},e.prototype.toggleDone=function(){this.model.toggle()},e.prototype.edit=function(){this.$el.addClass("editing"),this.input.focus()},e.prototype.close=function(){this.model.save({content:this.input.val()}),this.$el.removeClass("editing")},e.prototype.updateOnEnter=function(t){13==t.keyCode&&close()},e.prototype.clear=function(){this.model.clear()},e}(Backbone.View),AppView=function(t){function e(){t.call(this),this.events={"keypress #new-todo":"createOnEnter","keyup #new-todo":"showTooltip","click .todo-clear a":"clearCompleted","click .mark-all-done":"toggleAllComplete"},this.tooltipTimeout=null,this.setElement($("#todoapp"),!0),_.bindAll(this,"addOne","addAll","render","toggleAllComplete"),this.input=this.$("#new-todo"),this.allCheckbox=this.$(".mark-all-done")[0],this.statsTemplate=_.template($("#stats-template").html()),Todos.bind("add",this.addOne),Todos.bind("reset",this.addAll),Todos.bind("all",this.render),Todos.fetch()}return __extends(e,t),e.prototype.render=function(){var t=Todos.done().length,e=Todos.remaining().length;this.$("#todo-stats").html(this.statsTemplate({total:Todos.length,done:t,remaining:e})),this.allCheckbox.checked=!e},e.prototype.addOne=function(t){var e=new TodoView({model:t});this.$("#todo-list").append(e.render().el)},e.prototype.addAll=function(){Todos.each(this.addOne)},e.prototype.newAttributes=function(){return{content:this.input.val(),order:Todos.nextOrder(),done:!1}},e.prototype.createOnEnter=function(t){13==t.keyCode&&(Todos.create(this.newAttributes()),this.input.val(""))},e.prototype.clearCompleted=function(){return _.each(Todos.done(),function(t){return t.clear()}),!1},e.prototype.showTooltip=function(){var t=$(".ui-tooltip-top"),e=this.input.val();t.fadeOut(),this.tooltipTimeout&&clearTimeout(this.tooltipTimeout),""!=e&&e!=this.input.attr("placeholder")&&(this.tooltipTimeout=_.delay(function(){return t.show().fadeIn()},1e3))},e.prototype.toggleAllComplete=function(){var t=this.allCheckbox.checked;Todos.each(function(e){return e.save({done:t})})},e}(Backbone.View);$(function(){new AppView});